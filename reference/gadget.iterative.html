<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Removed functions — gadget.iterative • Rgadget</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Removed functions — gadget.iterative"><meta property="og:description" content="An implementation of the iterative reweigthing of likelihood
components in gadget. It analyzes a given gadget model and, after
a series of optimisations where each likelihood component is
heavily weigthed, suggests a weigthing for the components based on
the respective variance.  If one (or more) components, other than
understocking and penalty, are 0 then the gadget optimisation with
the final weights will not be completed."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rgadget</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/an-example-gadget-model.html">An example Gadget model: cod in Icelandic waters</a>
    </li>
    <li>
      <a href="../articles/building-models.html">Building models</a>
    </li>
    <li>
      <a href="../articles/iterative_reweighting.html">Weighing likelihood components using Rgadget</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Removed functions</h1>
    
    <div class="hidden name"><code>gadget.iterative.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>An implementation of the iterative reweigthing of likelihood
components in gadget. It analyzes a given gadget model and, after
a series of optimisations where each likelihood component is
heavily weigthed, suggests a weigthing for the components based on
the respective variance.  If one (or more) components, other than
understocking and penalty, are 0 then the gadget optimisation with
the final weights will not be completed.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">gadget.iterative</span><span class="op">(</span>
  main.file <span class="op">=</span> <span class="st">"main"</span>,
  gadget.exe <span class="op">=</span> <span class="st">"gadget"</span>,
  params.file <span class="op">=</span> <span class="st">"params.in"</span>,
  rew.sI <span class="op">=</span> <span class="cn">TRUE</span>,
  run.final <span class="op">=</span> <span class="cn">TRUE</span>,
  resume.final <span class="op">=</span> <span class="cn">FALSE</span>,
  wgts <span class="op">=</span> <span class="st">"WGTS"</span>,
  grouping <span class="op">=</span> <span class="cn">NULL</span>,
  optinfofile <span class="op">=</span> <span class="st">"optinfofile"</span>,
  run.serial <span class="op">=</span> <span class="cn">FALSE</span>,
  method <span class="op">=</span> <span class="st">"lm"</span>,
  cv.floor <span class="op">=</span> <span class="cn">NULL</span>,
  comp <span class="op">=</span> <span class="cn">NULL</span>,
  inverse <span class="op">=</span> <span class="cn">FALSE</span>,
  gd <span class="op">=</span> <span class="cn">NULL</span>,
  rew.cik <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">gadget.iterative</span><span class="op">(</span>
  main.file <span class="op">=</span> <span class="st">"main"</span>,
  gadget.exe <span class="op">=</span> <span class="st">"gadget"</span>,
  params.file <span class="op">=</span> <span class="st">"params.in"</span>,
  rew.sI <span class="op">=</span> <span class="cn">TRUE</span>,
  run.final <span class="op">=</span> <span class="cn">TRUE</span>,
  resume.final <span class="op">=</span> <span class="cn">FALSE</span>,
  wgts <span class="op">=</span> <span class="st">"WGTS"</span>,
  grouping <span class="op">=</span> <span class="cn">NULL</span>,
  optinfofile <span class="op">=</span> <span class="st">"optinfofile"</span>,
  run.serial <span class="op">=</span> <span class="cn">FALSE</span>,
  method <span class="op">=</span> <span class="st">"lm"</span>,
  cv.floor <span class="op">=</span> <span class="cn">NULL</span>,
  comp <span class="op">=</span> <span class="cn">NULL</span>,
  inverse <span class="op">=</span> <span class="cn">FALSE</span>,
  gd <span class="op">=</span> <span class="cn">NULL</span>,
  rew.cik <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>main.file</dt>
<dd><p>a string containing the location of the main file</p></dd>
<dt>gadget.exe</dt>
<dd><p>path to the gadget executable, if not set, first looks
to see if the gadget R package is installed, if that fails uses the system
path. .Options$gadget.path will override any given parameter.</p></dd>
<dt>params.file</dt>
<dd><p>a string containing the location of the input
parameters</p></dd>
<dt>rew.sI</dt>
<dd><p>logical, should survey indices be iteratively
reweighted (TRUE) or estimated using a linear model.</p></dd>
<dt>run.final</dt>
<dd><p>logical should the final optimisation be run
(DEBUG)</p></dd>
<dt>resume.final</dt>
<dd><p>logical should the final optimisation be
resumed (DEBUG)</p></dd>
<dt>wgts</dt>
<dd><p>a string containing the path the folder where the
interim weighting results should be stored.</p></dd>
<dt>grouping</dt>
<dd><p>a list naming the groups of components that should be reweighted together.</p></dd>
<dt>optinfofile</dt>
<dd><p>optinfofile used in the reweighting</p></dd>
<dt>run.serial</dt>
<dd><p>should the weighting run be run in parallel (used in
bootstrap).</p></dd>
<dt>method</dt>
<dd><p>linear model or loess smoother used to calculate SI
weights outside the gadget model. DEPRECATED</p></dd>
<dt>cv.floor</dt>
<dd><p>a value for an optional floor for survey indices
CV, used to prevent overfitting in the final run.</p></dd>
<dt>comp</dt>
<dd><p>string vector of names of likelihood components to be
used in the model (if NULL use all)</p></dd>
<dt>inverse</dt>
<dd><p>should inverse selection be used for likelihood
components</p></dd>
<dt>gd</dt>
<dd><p>the gadget model directory</p></dd>
<dt>rew.cik</dt>
<dd><p>logical, should the catch in kilos components be reweighted (default to FALSE)</p></dd>
<dt>...</dt>
<dd><p>pass to callGadget</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a matrix containing the weights of the likelihood
components at each iteration (defaults to FALSE).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>In Taylor et. al an objective reweighting scheme for likelihood
components is described for cod in Icelandic waters. The authors
nota that the issue of component weighting has been discussed for
some time, as the data sources have different natural scales (e.g
g vs. kg) that should not affect the outcome. A simple heuristic,
where the weights are the inverse of the initial sums of squares
for the respective component resulting in an initials score equal
to the number of components, is therfor often used. This has the
intutitive advantage of all components being normalised. There is
however a drawback to this since the component scores, given the
initial parametrisation, are most likely not equally far from
their respective optima resulting in sub-optimal weighting.  The
iterative reweighting heuristic tackles this problem by optimising
each component separately in order to determine the lowest
possible value for each component. This is then used to determine
the final weights.  The resoning for this approach is as follows:
Conceptually the likelihood components can be thought of as
residual sums of squares, and as such their variance can be
esimated by dividing the SS by the degrees of freedom. The optimal
weighting strategy is the inverse of the variance.  Here the
iteration starts with assigning the inverse SS as the initial
weight, that is the initial score of each component when
multiplied with the weight is 1. Then an optimisation run for each
component with the intial score for that component set to
10000. After the optimisation run the inverse of the resulting SS
is multiplied by the effective number of datapoints and used as
the final weight for that particular component.  The effective
number of datapoints is used as a proxy for the degrees of freedom
is determined from the number of non-zero datapoints. This is
viewed as satisfactory proxy when the dataset is large, but for
smaller datasets this could be a gross overestimate. In
particular, if the surveyindices are weigthed on their own while
the yearly recruitment is esimated they could be overfitted. If
there are two surveys within the year Taylor et. al suggest that
the corresponding indices from each survey are weigthed
simultaneously in order to make sure that there are at least two
measurement for each yearly recruit, this is done through
component grouping which is implemented. Another approach, which
is also implemented, for say a single survey fleet the weight for
each index component is estimated from a model of the form
$$\log(I_{lts}) = \mu + Y_t + \lambda_l + \Sigma_s +
\epsilon_{lts}$$ where the residual term, \(\epsilon_{lts}\), is
independent normal with variance
\(\sigma_{ls}^2\). The inverse of the estimated
variance from the above model as the weights between the
surveyindices.  After these weights have been determined all
surveyindices are weighted simultaneously.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Bjarki Þór Elvarsson</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">gadget.iterative</span><span class="op">(</span>rew.sI<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span class="r-in">                        grouping<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sind<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'si2039'</span>,<span class="st">'si4069'</span>,<span class="st">'si70110'</span><span class="op">)</span>,</span>
<span class="r-in">                        survey<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ldist.survey'</span>,<span class="st">'alkeys.survey'</span><span class="op">)</span>,</span>
<span class="r-in">                        catch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ldist.catch'</span>,<span class="st">'alkeys.catch'</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">                        params.file<span class="op">=</span><span class="st">'params.base'</span>,</span>
<span class="r-in">                        wgts<span class="op">=</span><span class="st">'WGTS'</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Bjarki Thor Elvarsson, Jamie Lentin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

